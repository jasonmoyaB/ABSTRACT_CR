@{
    ViewData["Title"] = "Mi Menú Semanal - Abstract";
}

<!-- Header Section -->
<section class="page-section clearfix" style="background: linear-gradient(135deg, rgba(230, 167, 86, 0.1) 0%, rgba(47, 23, 15, 0.05) 100%);">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <div class="intro-text left-0 text-center bg-faded p-5 rounded">
                    <h1 class="section-heading mb-4">
                        <span class="section-heading-upper text-primary">Mi</span>
                        <span class="section-heading-lower">Menú Semanal</span>
                    </h1>
                    <p class="lead mb-4">Tu plan nutricional personalizado de lunes a sábado, adaptado a tus preferencias y alergias.</p>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="text-center">
                    <div class="d-flex justify-content-center gap-3 mb-3">
                        <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#direccionModal">
                            <i class="fas fa-map-marker-alt me-2"></i>Dirección
                        </button>
                        <button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#pausarModal">
                            <i class="fas fa-pause me-2"></i>Pausar
                        </button>
                    </div>
                    <div class="d-flex justify-content-center">
                        <button class="btn btn-outline-secondary"
                                style="color: #e6a756; border-color: #e6a756;"
                                data-bs-toggle="modal"
                                data-bs-target="#historialModal">
                            <i class="fas fa-history me-2"></i>Historial
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Calendario Semanal -->
<section class="page-section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="text-center mb-5">
                    <h2 class="section-heading">
                        <span class="section-heading-upper" style="color:#e6a756">Esta Semana</span>
                        <span class="section-heading-lower" style="color:#f6e1c5">Lunes a Sábado</span>
                    </h2>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Lunes -->
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 border-0 shadow-sm menu-card" data-bs-toggle="modal" data-bs-target="#detalleModal" data-dia="Lunes">
                    <div class="card-header bg-primary text-white text-center">
                        <h5 class="mb-0">Lunes</h5>
                    </div>
                    <div class="card-body text-center p-4">
                        <img src="~/assets/img/FondoCarneMolida.jpeg" alt="Pollo a la plancha" class="img-fluid rounded mb-3" style="height: 150px; object-fit: cover; width: 100%;" />
                        <h6 class="card-title">Pollo a la plancha con vegetales</h6>
                        <div class="mb-3">
                            <span class="badge bg-success me-1">Sin gluten</span>
                            <span class="badge bg-info me-1">Alto en proteína</span>
                        </div>
                        <div class="d-flex justify-content-center gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation(); calificarPlato('lunes', 5);">
                                <i class="fas fa-thumbs-up"></i> Me gustó
                            </button>
                            <button class="btn btn-sm btn-outline-warning" onclick="event.stopPropagation(); toggleFavorito('lunes');">
                                <i class="fas fa-star"></i> Favorito
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Martes -->
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 border-0 shadow-sm menu-card" data-bs-toggle="modal" data-bs-target="#detalleModal" data-dia="Martes">
                    <div class="card-header bg-success text-white text-center">
                        <h5 class="mb-0">Martes</h5>
                    </div>
                    <div class="card-body text-center p-4">
                        <img src="~/assets/img/FondoAlbondigas.jpeg" alt="Salmón al horno" class="img-fluid rounded mb-3" style="height: 150px; object-fit: cover; width: 100%;" />
                        <h6 class="card-title">Salmón al horno con quinoa</h6>
                        <div class="mb-3">
                            <span class="badge bg-success me-1">Sin gluten</span>
                            <span class="badge bg-warning me-1">Omega-3</span>
                        </div>
                        <div class="d-flex justify-content-center gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation(); calificarPlato('martes', 5);">
                                <i class="fas fa-thumbs-up"></i> Me gustó
                            </button>
                            <button class="btn btn-sm btn-outline-warning" onclick="event.stopPropagation(); toggleFavorito('martes');">
                                <i class="fas fa-star"></i> Favorito
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Miércoles -->
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 border-0 shadow-sm menu-card" data-bs-toggle="modal" data-bs-target="#detalleModal" data-dia="Miércoles">
                    <div class="card-header bg-warning text-dark text-center">
                        <h5 class="mb-0">Miércoles</h5>
                    </div>
                    <div class="card-body text-center p-4">
                        <img src="~/assets/img/fondoReceta.jpeg" alt="Ensalada mediterránea" class="img-fluid rounded mb-3" style="height: 150px; object-fit: cover; width: 100%;" />
                        <h6 class="card-title">Ensalada mediterránea con atún</h6>
                        <div class="mb-3">
                            <span class="badge bg-success me-1">Sin gluten</span>
                            <span class="badge bg-info me-1">Vegetariano</span>
                        </div>
                        <div class="d-flex justify-content-center gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation(); calificarPlato('miercoles', 5);">
                                <i class="fas fa-thumbs-up"></i> Me gustó
                            </button>
                            <button class="btn btn-sm btn-outline-warning" onclick="event.stopPropagation(); toggleFavorito('miercoles');">
                                <i class="fas fa-star"></i> Favorito
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Jueves -->
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 border-0 shadow-sm menu-card" data-bs-toggle="modal" data-bs-target="#detalleModal" data-dia="Jueves">
                    <div class="card-header bg-info text-white text-center">
                        <h5 class="mb-0">Jueves</h5>
                    </div>
                    <div class="card-body text-center p-4">
                        <img src="~/assets/img/FondoRecipientes.jpeg" alt="Pasta integral" class="img-fluid rounded mb-3" style="height: 150px; object-fit: cover; width: 100%;" />
                        <h6 class="card-title">Pasta integral con vegetales</h6>
                        <div class="mb-3">
                            <span class="badge bg-info me-1">Integral</span>
                            <span class="badge bg-success me-1">Bajo en grasa</span>
                        </div>
                        <div class="d-flex justify-content-center gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation(); calificarPlato('jueves', 5);">
                                <i class="fas fa-thumbs-up"></i> Me gustó
                            </button>
                            <button class="btn btn-sm btn-outline-warning" onclick="event.stopPropagation(); toggleFavorito('jueves');">
                                <i class="fas fa-star"></i> Favorito
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Viernes -->
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 border-0 shadow-sm menu-card" data-bs-toggle="modal" data-bs-target="#detalleModal" data-dia="Viernes">
                    <div class="card-header bg-danger text-white text-center">
                        <h5 class="mb-0">Viernes</h5>
                    </div>
                    <div class="card-body text-center p-4">
                        <img src="~/assets/img/FondoCarneMolida.jpeg" alt="Carne magra" class="img-fluid rounded mb-3" style="height: 150px; object-fit: cover; width: 100%;" />
                        <h6 class="card-title">Carne magra con puré de papa</h6>
                        <div class="mb-3">
                            <span class="badge bg-success me-1">Sin gluten</span>
                            <span class="badge bg-info me-1">Alto en hierro</span>
                        </div>
                        <div class="d-flex justify-content-center gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation(); calificarPlato('viernes', 5);">
                                <i class="fas fa-thumbs-up"></i> Me gustó
                            </button>
                            <button class="btn btn-sm btn-outline-warning" onclick="event.stopPropagation(); toggleFavorito('viernes');">
                                <i class="fas fa-star"></i> Favorito
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sábado -->
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 border-0 shadow-sm menu-card" data-bs-toggle="modal" data-bs-target="#detalleModal" data-dia="Sábado">
                    <div class="card-header bg-secondary text-white text-center">
                        <h5 class="mb-0">Sábado</h5>
                    </div>
                    <div class="card-body text-center p-4">
                        <img src="~/assets/img/fondoReceta.jpeg" alt="Sopa de vegetales" class="img-fluid rounded mb-3" style="height: 150px; object-fit: cover; width: 100%;" />
                        <h6 class="card-title">Sopa de vegetales con pollo</h6>
                        <div class="mb-3">
                            <span class="badge bg-success me-1">Sin gluten</span>
                            <span class="badge bg-info me-1">Bajo en calorías</span>
                        </div>
                        <div class="d-flex justify-content-center gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation(); calificarPlato('sabado', 5);">
                                <i class="fas fa-thumbs-up"></i> Me gustó
                            </button>
                            <button class="btn btn-sm btn-outline-warning" onclick="event.stopPropagation(); toggleFavorito('sabado');">
                                <i class="fas fa-star"></i> Favorito
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Modal Detalle del Día -->
<div class="modal fade" id="detalleModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Detalle del Día - <span id="diaSeleccionado"></span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <img id="imagenPlato" src="" alt="Plato" class="img-fluid rounded mb-3" />
                    </div>
                    <div class="col-md-6">
                        <h6 id="nombrePlato"></h6>
                        <div id="etiquetasPlato" class="mb-3"></div>
                        
                        <h6>Ingredientes principales:</h6>
                        <ul id="ingredientesLista" class="list-unstyled">
                            <!-- Se llenará dinámicamente -->
                        </ul>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-lightbulb me-2"></i>
                            <strong>Tip del Chef:</strong>
                            <p id="tipChef" class="mb-0 mt-2"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a href="@Url.Action("AgregarAlergia", "Usuario")" class="btn btn-warning">
                    <i class="fas fa-plus me-2"></i>Agregar nueva alergia
                </a>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Dirección de Entrega -->
<div class="modal fade" id="direccionModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Dirección de Entrega</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Provincia</label>
                            <select class="form-select" required>
                                <option value="">Seleccionar provincia</option>
                                <option value="san-jose">San José</option>
                                <option value="alajuela">Alajuela</option>
                                <option value="cartago">Cartago</option>
                                <option value="heredia">Heredia</option>
                                <option value="guanacaste">Guanacaste</option>
                                <option value="puntarenas">Puntarenas</option>
                                <option value="limon">Limón</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Cantón</label>
                            <select class="form-select" required>
                                <option value="">Seleccionar cantón</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Dirección exacta</label>
                        <textarea class="form-control" rows="3" placeholder="Dirección completa" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Punto de referencia</label>
                        <input type="text" class="form-control" placeholder="Ej: 100m norte del parque">
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Teléfono</label>
                            <input type="tel" class="form-control" placeholder="8888-8888" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Horario preferido</label>
                            <select class="form-select">
                                <option value="manana">Mañana (8:00 AM - 12:00 PM)</option>
                                <option value="tarde">Tarde (12:00 PM - 5:00 PM)</option>
                                <option value="noche">Noche (5:00 PM - 8:00 PM)</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary">Guardar Cambios</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Pausar Suscripción -->
<div class="modal fade" id="pausarModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Pausar Mi Suscripción</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <strong>Importante:</strong> Al pausar tu suscripción, no recibirás entregas durante el período seleccionado.
                </div>
                <form>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Fecha de inicio</label>
                            <input type="date" class="form-control" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Fecha de fin</label>
                            <input type="date" class="form-control" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Motivo (opcional)</label>
                        <textarea class="form-control" rows="3" placeholder="¿Por qué pausas tu suscripción?"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-warning">Pausar Suscripción</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Historial -->
<div class="modal fade" id="historialModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Historial de Entregas</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <select class="form-select" id="semanaSelector">
                            <option value="">Seleccionar semana</option>
                            <option value="semana1">Semana del 1-7 Enero 2024</option>
                            <option value="semana2">Semana del 8-14 Enero 2024</option>
                            <option value="semana3">Semana del 15-21 Enero 2024</option>
                        </select>
                    </div>
                </div>
                <div id="historialContenido">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<style>
.menu-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
}

.menu-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.1) !important;
}

.btn {
    transition: all 0.3s ease;
}

.btn:hover {
    transform: translateY(-2px);
}

.card-header {
    border-bottom: none;
}

.badge {
    font-size: 0.75rem;
}
</style>

<script>
// Datos de los platos
const platosData = {
    'Lunes': {
        nombre: 'Pollo a la plancha con vegetales',
        imagen: '/assets/img/FondoCarneMolida.jpeg',
        etiquetas: ['Sin gluten', 'Alto en proteína'],
        ingredientes: ['Pechuga de pollo', 'Brócoli', 'Zanahoria', 'Arroz integral'],
        tipChef: 'Cocina el pollo a fuego medio para mantenerlo jugoso y tierno.'
    },
    'Martes': {
        nombre: 'Salmón al horno con quinoa',
        imagen: '/assets/img/FondoAlbondigas.jpeg',
        etiquetas: ['Sin gluten', 'Omega-3'],
        ingredientes: ['Salmón fresco', 'Quinoa', 'Espárragos', 'Limón'],
        tipChef: 'El salmón debe estar rosado por dentro, no completamente cocido.'
    },
    'Miércoles': {
        nombre: 'Ensalada mediterránea con atún',
        imagen: '/assets/img/fondoReceta.jpeg',
        etiquetas: ['Sin gluten', 'Vegetariano'],
        ingredientes: ['Lechuga', 'Tomate', 'Pepino', 'Atún', 'Aceite de oliva'],
        tipChef: 'Agrega un toque de limón fresco justo antes de servir.'
    },
    'Jueves': {
        nombre: 'Pasta integral con vegetales',
        imagen: '/assets/img/FondoRecipientes.jpeg',
        etiquetas: ['Integral', 'Bajo en grasa'],
        ingredientes: ['Pasta integral', 'Calabacín', 'Champiñones', 'Salsa de tomate'],
        tipChef: 'Cocina la pasta al dente para mejor textura y digestión.'
    },
    'Viernes': {
        nombre: 'Carne magra con puré de papa',
        imagen: '/assets/img/FondoCarneMolida.jpeg',
        etiquetas: ['Sin gluten', 'Alto en hierro'],
        ingredientes: ['Carne de res magra', 'Papa', 'Leche', 'Mantequilla'],
        tipChef: 'Deja reposar la carne 5 minutos antes de cortarla.'
    },
    'Sábado': {
        nombre: 'Sopa de vegetales con pollo',
        imagen: '/assets/img/fondoReceta.jpeg',
        etiquetas: ['Sin gluten', 'Bajo en calorías'],
        ingredientes: ['Pollo', 'Zanahoria', 'Apio', 'Cebolla', 'Caldo de pollo'],
        tipChef: 'Cocina a fuego lento para extraer todos los sabores.'
    }
};

// Función para mostrar detalles del día
document.addEventListener('DOMContentLoaded', function() {
    const detalleModal = document.getElementById('detalleModal');
    detalleModal.addEventListener('show.bs.modal', function(event) {
        const button = event.relatedTarget;
        const dia = button.getAttribute('data-dia');
        const plato = platosData[dia];
        
        document.getElementById('diaSeleccionado').textContent = dia;
        document.getElementById('nombrePlato').textContent = plato.nombre;
        document.getElementById('imagenPlato').src = plato.imagen;
        
        // Mostrar etiquetas
        const etiquetasHtml = plato.etiquetas.map(etiqueta => 
            `<span class="badge bg-success me-1">${etiqueta}</span>`
        ).join('');
        document.getElementById('etiquetasPlato').innerHTML = etiquetasHtml;
        
        // Mostrar ingredientes
        const ingredientesHtml = plato.ingredientes.map(ingrediente => 
            `<li><i class="fas fa-check text-success me-2"></i>${ingrediente}</li>`
        ).join('');
        document.getElementById('ingredientesLista').innerHTML = ingredientesHtml;
        
        // Mostrar tip del chef
        document.getElementById('tipChef').textContent = plato.tipChef;
    });
});

// Función para calificar plato
function calificarPlato(dia, calificacion) {
    console.log(`Plato de ${dia} calificado con ${calificacion} estrellas`);
    // Aquí se implementaría la lógica para guardar la calificación
    alert(`¡Gracias por calificar el plato del ${dia}!`);
}

// Función para marcar como favorito
function toggleFavorito(dia) {
    console.log(`Plato de ${dia} marcado como favorito`);
    // Aquí se implementaría la lógica para marcar como favorito
    alert(`Plato del ${dia} agregado a favoritos`);
}
</script> 